{% extends "base.html" %}

{% block title %}Админ панель – Белый список{% endblock %}

{% block content %}
<main class="container">
  <h1>Администрирование Белого списка</h1>

  <!-- Форма для добавления никнейма, по которому будет автоматически доставлен UUID -->
  <form id="add-to-whitelist-form">
    <input type="text" id="username-input" placeholder="Введите ник" required>
    <button type="submit">Добавить в белый список</button>
  </form>

  <script>
    document.getElementById("add-to-whitelist-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const username = document.getElementById("username-input").value;

      fetch("/api/add_to_whitelist", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username: username })
      })
      .then(response => response.json())
      .then(data => {
        alert(data.message || data.error);
        // Здесь можно добавить код для обновления списка на странице
      })
      .catch(error => console.error("Error:", error));
    });
  </script>

  <!-- Отображение текущего белого списка -->
  {% if whitelist %}
    <h2>Текущий Белый список</h2>
    <ul>
      {% for uuid in whitelist %}
        <li>{{ uuid }}</li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Белый список пуст.</p>
  {% endif %}
</main>
{% endblock %}
