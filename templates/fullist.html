{% extends "base.html" %}

{% set page_title = "Полный список | ЧС Сосмарка" %}
{% set page_description = "Полный список записей в черном списке Сосмаркской Империи. Просматривайте все записи с подробной информацией." %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/fullist.css') }}">
{# Import Supabase JS library #}
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
{% endblock %}

{% block content %}
<div class="fullist-container">
  <h1>Полный список</h1>

  <div class="search-container">
    <input type="text"
           id="searchInput"
           placeholder="Поиск по никнейму или причине..."
           aria-label="Поиск по списку"
           class="search-input">
  </div>
  
  {# Placeholder for filter controls - to be added if desired #}
  {# <div class="filter-controls" style="margin-bottom: 20px; padding: 15px; background-color: #333; border-radius: 5px;">
    <select id="sortBy" style="margin-right: 10px;">
        <option value="created_at">Дата добавления</option>
        <option value="nickname">Никнейм</option>
    </select>
    <select id="sortOrder" style="margin-right: 10px;">
        <option value="desc">По убыванию</option>
        <option value="asc">По возрастанию</option>
    </select>
    <input type="date" id="dateFrom" style="margin-right: 10px;">
    <input type="date" id="dateTo" style="margin-right: 10px;">
    <button id="applyFiltersBtn">Применить фильтры</button>
  </div> #}

  <div id="blacklistContainer" class="blacklist-entries" role="list">
    <!-- Entries will be loaded dynamically -->
  </div>
  <div id="loadingIndicator" style="display: none; text-align: center; margin: 20px;">
      <p>Загрузка...</p>
  </div>
  <div id="noMoreResultsIndicator" style="display: none; text-align: center; margin: 20px; color: grey;">
      <p>Больше нет записей.</p>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const SUPABASE_URL = '{{ SUPABASE_URL }}';
  const SUPABASE_ANON_KEY = '{{ SUPABASE_KEY }}';
  let supabase = null;

  if (SUPABASE_URL && SUPABASE_ANON_KEY && SUPABASE_URL !== 'None' && SUPABASE_ANON_KEY !== 'None') {
    try {
        supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        console.log("Supabase client initialized for fullist.");
    } catch (e) {
        console.error("Error initializing Supabase client for fullist:", e);
        alert("Не удалось инициализировать клиент Supabase. Обновления в реальном времени не будут работать.");
    }
  } else {
    console.warn("Supabase URL or Anon Key not configured for fullist. Realtime updates will not work.");
  }
</script>
<script src="{{ url_for('static', filename='js/pages/fullist.js') }}" defer></script>
{% endblock %}