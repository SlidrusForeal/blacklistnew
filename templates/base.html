<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  {# Child templates can override the page_title variable if desired #}
  {% set page_title = page_title|default("ЧС Сосмарка") %}
  <title>{{ page_title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO Meta Tags -->
  <meta name="description" content="Проверьте наличие вашего никнейма в черном списке Сосмаркской Империи. Мгновенная проверка и актуальные данные.">
  <meta name="keywords" content="ЧС, черный список, Сосмарк, blacklist, проверка никнейма">
  <meta name="robots" content="index, follow">
  <meta name="author" content="SlidrusForeal">

  <!-- Open Graph Meta Tags -->
  <meta property="og:site_name" content="ЧС Сосмарка">
  <meta property="og:title" content="{{ page_title }}">
  <meta property="og:description" content="Проверьте наличие вашего никнейма в черном списке Сосмаркской Империи.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ request.url }}">
  <meta property="og:image" content="{{ url_for('static', filename='icons/og-image.png') }}">
  <meta property="og:locale" content="ru_RU">

  <!-- PWA and Icons -->
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='icons/apple-touch-icon.png') }}">
  <link rel="icon" href="{{ url_for('static', filename='icons/favicon.ico') }}" type="image/x-icon">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">

  <!-- CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

  {% block head %}{% endblock %}
</head>
<body>
  <noscript>Для работы приложения требуется JavaScript</noscript>

  <header>
    <nav>
      <ul>
        <li><a href="{{ url_for('index') }}">Главная</a></li>
        {% if current_user.is_authenticated %}
          <li><a href="{{ url_for('logout') }}">Выйти</a></li>
        {% else %}
          <li><a href="{{ url_for('login') }}">Войти</a></li>
        {% endif %}
        <li><a href="{{ url_for('fullist') }}">Полный список</a></li>
        <li><a href="{{ url_for('contacts') }}">Контакты</a></li>
      </ul>
    </nav>
  </header>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="notification">
      {% for category, message in messages %}
        <p class="{{ category }}">{{ message }}</p>
      {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}

  <footer>
    <p>&copy; <span id="year">{{ current_year() }}</span> Сосмарк. Все права защищены.</p>
  </footer>

  <!-- Service Worker registration -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('{{ url_for("static", filename="service-worker.js") }}')
        .then(reg => console.log("✅ Service Worker зарегистрирован", reg))
        .catch(err => console.error("❌ Service Worker ошибка", err));
    }
  </script>
</body>
</html>
